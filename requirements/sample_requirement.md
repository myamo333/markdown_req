# 第1章 自動運転支援システム要件

## 第1.1節 目的と範囲

- 本要件は高速道路向けレベル2自動運転支援（以下、ADS-L2）機能を対象とする。
- 制御対象は自車の加減速・車線維持・追従制御であり、ドライバは常に監視責任を負う。

## 第1.2節 主要コンポーネント

| コンポーネント             | 役割                         | インタフェース      |
| -------------------------- | ---------------------------- | ------------------- |
| SDU (Self Driving Unit)    | 自動運転ロジックとモード管理 | Ethernet / CAN FD   |
| VCU (Vehicle Control Unit) | アクチュエータ制御実行       | LocalBus            |
| HMI Cluster                | ドライバ通知・操作入力       | LIN / CAN           |
| Sensor Suite               | カメラ・レーダ・LiDAR        | FPD-Link / Ethernet |

## 第1.3節 要件一覧

### ADSモード制御

- [REQ-ADS-001]
  SDUは車速が30km/h以上で、高速道路シナリオが確定しているときにのみADS-L2モード遷移を許可すること。
- [REQ-ADS-002]
  ADS-L2モード中にハンズオフ検出時間が15秒を超過した場合、段階的なテイクオーバーリクエストを発行すること。
- [REQ-ADS-003]
  ドライバがステアリングトルクを0.5Nm以上加えた場合、手動モードへ即時遷移すること。

### 走行制御

- [REQ-ADS-010]
  SDUは前走車との距離を0.8～2.0秒の時間ギャップ内に保つようV-Curve制御を実行すること。
- [REQ-ADS-011]
  カメラレーンマーカーが連続3フレーム喪失した場合、レーダベースの車線維持制御へシームレスに切り替えること。
- [REQ-ADS-012]
  急制動（減速度3.5m/s²以上）が発生した際は、HMIに即時警告を表示し、イベントログを保存すること。

### 安全監視

- [REQ-ADS-020]
  センサハートビートを100ms周期で監視し、2周期連続で欠落した場合はフォールバック計画を起動すること。
- [REQ-ADS-021]
  SDUは冗長ECU（SDU-B）からの健全性ビットを50ms周期で受信し、ミスマッチ時は自律判断を停止すること。
- [REQ-ADS-022]
  ADS-L2モード中の車線逸脱角度が3度を超えた場合、ハプティクス警告を 500ms 周期で提示すること。

## 第1.4節 条件記述

> 条件：高速道路マップマッチングが完了し、GPS精度が1m以内かつ天候タグが「通常」のとき、ADS-L2モードを解放する。ドライバ要求が優先される。

## 第1.5節 信号定義

| 信号名                  | 種別 | 方向      | 説明                 |
| ----------------------- | ---- | --------- | -------------------- |
| ADS_MODE_STATUS         | UINT | SDU→HMI   | 自動運転モードID     |
| ADS_TOR_REQUEST         | BOOL | SDU→VCU   | 車線維持制御指令     |
| DRIVER_TAKEOVER_REQUEST | BOOL | SDU→HMI   | テイクオーバー要求   |
| DRIVER_HANDS_DETECTED   | BOOL | HMI→SDU   | ハンドオン検知       |
| SDU_REDUNDANCY_STATUS   | UINT | SDU-B→SDU | 冗長ユニットの健全性 |

## 第1.6節 テストケース

### 正常系

| No        | テスト項目           | 概要                                  | 期待結果                             |
| --------- | -------------------- | ------------------------------------- | ------------------------------------ |
| TC-ADS-01 | ADSモード遷移        | 高速道路シナリオで時速60km/h→モードON | ADS_MODE_STATUSがL2に変化、警告なし  |
| TC-ADS-02 | ハンズオフ検知       | ADS中に15秒ハンズオフ保持             | DRIVER_TAKEOVER_REQUESTが3段階で出力 |
| TC-ADS-03 | 車線維持バックアップ | カメラ欠落を3フレーム連続で模擬       | レーダ制御に切替、車線逸脱なし       |

### 異常系

| No        | テスト項目         | 概要                            | 期待結果                            |
| --------- | ------------------ | ------------------------------- | ----------------------------------- |
| TC-ADS-10 | 冗長ECUミスマッチ  | SDU-B健全性ビットをエラーに設定 | ADS_MODE_STATUSが安全モードへ遷移   |
| TC-ADS-11 | ハプティクス警告   | 車線逸脱角3度を維持             | 500ms周期でハプティクス警告を送出   |
| TC-ADS-12 | 急制動イベントログ | 前走車急停止を模擬              | ログ保存＋HMIに「急制動」警告を表示 |

## 第1.7節 品質指標

- 自動運転モード中の意図しない解除率は10,000kmあたり0.5件以下。
- 手動モード復帰時間はドライバ操作検知後1.0秒以内。
- イベントログはISO/PAS 21448（SOTIF）の追跡要件に従い保管する。

## 付録 A: 用語

| 用語  | 説明                           |
| ----- | ------------------------------ |
| ADS   | Automated Driving System       |
| SDU   | Self Driving Unit              |
| SDU-B | 冗長構成のバックアップSDU      |
| HMI   | ヒューマンマシンインタフェース |
| VCU   | Vehicle Control Unit           |
